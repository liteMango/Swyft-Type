
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Typing Test</title>
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #007acc;
            --accent: #ffd700;
            --accent2: #36c7fa;
            --danger: #ff4757;
            --surface: #1e2746;
            --input-bg: #2a3652;
            --input-border: #3a4662;
            --text-secondary: #8c9db5;
            --box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
            --radius: 16px;
            --primary-glow: rgba(0, 122, 204, 0.3);
            --glass-bg: rgba(46, 54, 82, 0.8);
            --loader: #36c7fa;
        }

        body.light {
            --surface: #ffffff;
            --input-bg: #f8f9fa;
            --input-border: #e9ecef;
            --text-secondary: #6c757d;
            --primary: #0056b3;
            background: #f8f9fa;
            color: #212529;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', Arial, sans-serif;
            background: #191d30;
            color: #ffffff;
            transition: all 0.3s ease;
        }

        /* Header Styles */
        header {
            background: #131741;
            border-bottom: 1px solid #2a3652;
            padding: 0;
        }

        .header-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 2rem;
        }

        .logo img {
            height: 40px;
            border-radius: 8px;
        }

        nav {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: color 0.2s;
        }

        nav a:hover {
            color: var(--accent);
        }

        .mode-toggle {
            background: none;
            border: none;
            color: var(--accent);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.2s;
        }

        /* Main Container */
        main {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Timer Controls */
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .controls button {
            padding: 0.75rem 1rem;
            font-size: 0.9rem;
            border-radius: 12px;
            border: 2px solid var(--accent);
            background: var(--surface);
            color: var(--accent);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .controls button.active,
        .controls button:hover {
            background: var(--accent);
            color: #191d30;
        }

        .controls button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Typing Container */
        .typing-container {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--box-shadow);
            margin-bottom: 2rem;
            min-height: 400px;
            position: relative;
        }

        .visual-timer {
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 1.5rem;
            font-family: 'Courier New', monospace;
            background: rgba(255, 215, 0, 0.1);
            padding: 1rem;
            border-radius: 12px;
            border: 2px solid var(--accent);
        }

        .start-msg, .end-msg {
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin: 1rem 0;
            font-weight: 600;
        }

        .end-msg {
            color: var(--accent);
            background: rgba(255, 215, 0, 0.1);
            padding: 1rem;
            border-radius: 12px;
            display: none;
        }

        .typing-text {
            font-size: 1.1rem;
            line-height: 1.8;
            margin: 2rem 0;
            text-align: justify;
            min-height: 150px;
        }

        .typing-text span {
            position: relative;
        }

        .typing-text span.active {
            background: var(--accent);
            color: #191d30;
            border-radius: 3px;
            animation: blink 1s infinite;
        }

        .typing-text span.correct {
            color: #5cf4a2;
            background: rgba(92, 244, 162, 0.1);
            border-radius: 3px;
        }

        .typing-text span.incorrect {
            color: var(--danger);
            background: rgba(255, 71, 87, 0.2);
            border-radius: 3px;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: rgba(54, 199, 250, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(54, 199, 250, 0.3);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }

        .try-again-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: block;
            margin: 2rem auto 0;
            transition: all 0.2s;
        }

        .try-again-btn:hover {
            background: var(--accent);
            color: #191d30;
            transform: translateY(-2px);
        }

        /* Loader */
        .loader {
            display: none;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }

        .lds-ring {
            display: inline-block;
            position: relative;
            width: 60px;
            height: 60px;
        }

        .lds-ring div {
            box-sizing: border-box;
            display: block;
            position: absolute;
            width: 48px;
            height: 48px;
            margin: 6px;
            border: 5px solid var(--loader);
            border-radius: 50%;
            animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            border-color: var(--loader) transparent transparent transparent;
        }

        .lds-ring div:nth-child(1) { animation-delay: -0.45s; }
        .lds-ring div:nth-child(2) { animation-delay: -0.3s; }
        .lds-ring div:nth-child(3) { animation-delay: -0.15s; }

        @keyframes lds-ring {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Language Selector */
        .language-selector {
            position: relative;
            display: inline-block;
        }

        .language-selector select {
            background: var(--surface);
            color: var(--accent);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 0.5rem;
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .controls {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .typing-container {
                padding: 1rem;
            }
            
            .visual-timer {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            main {
                padding: 1rem;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-inner">
            <div class="logo">
                <a href="index.html"><img src="logo-png.png" alt="Typing Test"></a>
            </div>
            <nav>
                <div class="language-selector">
                    <select id="lang-select">
                        <option value="en">ðŸ‡ºðŸ‡¸ English</option>
                        <option value="es">ðŸ‡ªðŸ‡¸ Spanish</option>
                        <option value="fr">ðŸ‡«ðŸ‡· French</option>
                        <option value="de">ðŸ‡©ðŸ‡ª German</option>
                        <option value="ig">NG Igbo</option>
                    </select>
                </div>
                <a href="about.html">About</a>
                <a href="/Leaderboard/leaderboard.html">Leaderboard</a>
                <!-- <a href="#settings">Settings</a> -->
                <button class="mode-toggle" id="modeToggle" title="Toggle theme">ðŸŒ™</button>
            </nav>
        </div>
    </header>

    <main>
        <div class="controls">
            <button data-time="30" data-unit="seconds">30s</button>
            <button data-time="60" data-unit="seconds" class="active">1m</button>
            <button data-time="120" data-unit="seconds">2m</button>
            <button data-time="300" data-unit="seconds">5m</button>
            <button data-time="600" data-unit="seconds">10m</button>
            <button id="resetButton">Reset</button>
        </div>

        <div class="typing-container" id="typingContainer" tabindex="0">
            <div class="visual-timer" id="visualTimer">01:00</div>
            
            <div class="start-msg" id="startMsg">Click here or start typing to begin!</div>
            <div class="end-msg" id="endMsg"></div>
            
            <div class="typing-text" id="typingText"></div>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-label">Time Left</div>
                    <div class="stat-value" id="timeLeft">01:00</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Mistakes</div>
                    <div class="stat-value" id="mistakes">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">WPM</div>
                    <div class="stat-value" id="wpm">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">CPM</div>
                    <div class="stat-value" id="cpm">0</div>
                </div>
            </div>
            
            <button class="try-again-btn" id="tryAgainBtn">Try Again</button>
            <p>Total visits: <span id="hitCount">0</span></p>
            <div class="loader" id="loader">
                <div class="lds-ring">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>
        
    </main>

    <footer class="footer">
  <div class="footer-container">
    <div class="footer-top">
      <div class="footer-logo">
        <a href="index.html">âš¡ Swyft-Type</a>
      </div>
      <nav class="footer-nav">
        <a href="about.html">About Us</a>
        <a href="/Leaderboard/leaderboard.html">Leaderboard</a>
        <!-- <a href="contact.html">Contact</a> -->
      </nav>
    </div>
    <p class="footer-copy">Â© 2025 Swyft-Type. All rights reserved.</p>
  </div>

  <!-- Social icons moved outside container -->
  <div class="footer-social">
    <a href="#" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-twitter-x" viewBox="0 0 16 16">
  <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"/>
</svg></a>
    <a href="#" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 320 512"><!--!Font Awesome Free v7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M80 299.3l0 212.7 116 0 0-212.7 86.5 0 18-97.8-104.5 0 0-34.6c0-51.7 20.3-71.5 72.7-71.5 16.3 0 29.4 .4 37 1.2l0-88.7C291.4 4 256.4 0 236.2 0 129.3 0 80 50.5 80 159.4l0 42.1-66 0 0 97.8 66 0z"/></svg></a>
    <a href="#" aria-label="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" fill="currentColor" viewBox="0 0 640 640"><!--!Font Awesome Free v7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M290.4 275.7C274 286 264.5 304.5 265.5 323.8C266.6 343.2 278.2 360.4 295.6 368.9C313.1 377.3 333.8 375.5 349.6 364.3C366 354 375.5 335.5 374.5 316.2C373.4 296.8 361.8 279.6 344.4 271.1C326.9 262.7 306.2 264.5 290.4 275.7zM432.7 207.3C427.5 202.1 421.2 198 414.3 195.3C396.2 188.2 356.7 188.5 331.2 188.8C327.1 188.8 323.3 188.9 320 188.9C316.7 188.9 312.8 188.9 308.6 188.8C283.1 188.5 243.8 188.1 225.7 195.3C218.8 198 212.6 202.1 207.3 207.3C202 212.5 198 218.8 195.3 225.7C188.2 243.8 188.6 283.4 188.8 308.9C188.8 313 188.9 316.8 188.9 320C188.9 323.2 188.9 327 188.8 331.1C188.6 356.6 188.2 396.2 195.3 414.3C198 421.2 202.1 427.4 207.3 432.7C212.5 438 218.8 442 225.7 444.7C243.8 451.8 283.3 451.5 308.8 451.2C312.9 451.2 316.7 451.1 320 451.1C323.3 451.1 327.2 451.1 331.4 451.2C356.9 451.5 396.2 451.9 414.3 444.7C421.2 442 427.4 437.9 432.7 432.7C438 427.5 442 421.2 444.7 414.3C451.9 396.3 451.5 356.9 451.2 331.3C451.2 327.1 451.1 323.2 451.1 319.9C451.1 316.6 451.1 312.8 451.2 308.5C451.5 283 451.9 243.6 444.7 225.5C442 218.6 437.9 212.4 432.7 207.1L432.7 207.3zM365.6 251.8C383.7 263.9 396.2 282.7 400.5 304C404.8 325.3 400.3 347.5 388.2 365.6C382.2 374.6 374.5 382.2 365.6 388.2C356.7 394.2 346.6 398.3 336 400.4C314.7 404.6 292.5 400.2 274.4 388.1C256.3 376 243.8 357.2 239.5 335.9C235.2 314.6 239.7 292.4 251.7 274.3C263.7 256.2 282.6 243.7 303.9 239.4C325.2 235.1 347.4 239.6 365.5 251.6L365.6 251.6zM394.8 250.5C391.7 248.4 389.2 245.4 387.7 241.9C386.2 238.4 385.9 234.6 386.6 230.8C387.3 227 389.2 223.7 391.8 221C394.4 218.3 397.9 216.5 401.6 215.8C405.3 215.1 409.2 215.4 412.7 216.9C416.2 218.4 419.2 220.8 421.3 223.9C423.4 227 424.5 230.7 424.5 234.5C424.5 237 424 239.5 423.1 241.8C422.2 244.1 420.7 246.2 419 248C417.3 249.8 415.1 251.2 412.8 252.2C410.5 253.2 408 253.7 405.5 253.7C401.7 253.7 398 252.6 394.9 250.5L394.8 250.5zM544 160C544 124.7 515.3 96 480 96L160 96C124.7 96 96 124.7 96 160L96 480C96 515.3 124.7 544 160 544L480 544C515.3 544 544 515.3 544 480L544 160zM453 453C434.3 471.7 411.6 477.6 386 478.9C359.6 480.4 280.4 480.4 254 478.9C228.4 477.6 205.7 471.7 187 453C168.3 434.3 162.4 411.6 161.2 386C159.7 359.6 159.7 280.4 161.2 254C162.5 228.4 168.3 205.7 187 187C205.7 168.3 228.5 162.4 254 161.2C280.4 159.7 359.6 159.7 386 161.2C411.6 162.5 434.3 168.3 453 187C471.7 205.7 477.6 228.4 478.8 254C480.3 280.3 480.3 359.4 478.8 385.9C477.5 411.5 471.7 434.2 453 452.9L453 453z"/></svg></a>
    <a href="#" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" fill="currentColor" viewBox="0 0 640 640"><!--!Font Awesome Free v7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M237.9 461.4C237.9 463.4 235.6 465 232.7 465C229.4 465.3 227.1 463.7 227.1 461.4C227.1 459.4 229.4 457.8 232.3 457.8C235.3 457.5 237.9 459.1 237.9 461.4zM206.8 456.9C206.1 458.9 208.1 461.2 211.1 461.8C213.7 462.8 216.7 461.8 217.3 459.8C217.9 457.8 216 455.5 213 454.6C210.4 453.9 207.5 454.9 206.8 456.9zM251 455.2C248.1 455.9 246.1 457.8 246.4 460.1C246.7 462.1 249.3 463.4 252.3 462.7C255.2 462 257.2 460.1 256.9 458.1C256.6 456.2 253.9 454.9 251 455.2zM316.8 72C178.1 72 72 177.3 72 316C72 426.9 141.8 521.8 241.5 555.2C254.3 557.5 258.8 549.6 258.8 543.1C258.8 536.9 258.5 502.7 258.5 481.7C258.5 481.7 188.5 496.7 173.8 451.9C173.8 451.9 162.4 422.8 146 415.3C146 415.3 123.1 399.6 147.6 399.9C147.6 399.9 172.5 401.9 186.2 425.7C208.1 464.3 244.8 453.2 259.1 446.6C261.4 430.6 267.9 419.5 275.1 412.9C219.2 406.7 162.8 398.6 162.8 302.4C162.8 274.9 170.4 261.1 186.4 243.5C183.8 237 175.3 210.2 189 175.6C209.9 169.1 258 202.6 258 202.6C278 197 299.5 194.1 320.8 194.1C342.1 194.1 363.6 197 383.6 202.6C383.6 202.6 431.7 169 452.6 175.6C466.3 210.3 457.8 237 455.2 243.5C471.2 261.2 481 275 481 302.4C481 398.9 422.1 406.6 366.2 412.9C375.4 420.8 383.2 435.8 383.2 459.3C383.2 493 382.9 534.7 382.9 542.9C382.9 549.4 387.5 557.3 400.2 555C500.2 521.8 568 426.9 568 316C568 177.3 455.5 72 316.8 72zM169.2 416.9C167.9 417.9 168.2 420.2 169.9 422.1C171.5 423.7 173.8 424.4 175.1 423.1C176.4 422.1 176.1 419.8 174.4 417.9C172.8 416.3 170.5 415.6 169.2 416.9zM158.4 408.8C157.7 410.1 158.7 411.7 160.7 412.7C162.3 413.7 164.3 413.4 165 412C165.7 410.7 164.7 409.1 162.7 408.1C160.7 407.5 159.1 407.8 158.4 408.8zM190.8 444.4C189.2 445.7 189.8 448.7 192.1 450.6C194.4 452.9 197.3 453.2 198.6 451.6C199.9 450.3 199.3 447.3 197.3 445.4C195.1 443.1 192.1 442.8 190.8 444.4zM179.4 429.7C177.8 430.7 177.8 433.3 179.4 435.6C181 437.9 183.7 438.9 185 437.9C186.6 436.6 186.6 434 185 431.7C183.6 429.4 181 428.4 179.4 429.7z"/></svg></a>
  </div>
</footer>

<style>
    .footer-icons {
  display: flex;
  justify-content: center; /* center horizontally */
  gap: 1.5rem; /* spacing between icons */
}

.footer-icons .icon {
  font-size: 28px;   /* same size for all */
  display: inline-block;
  line-height: 1;
  transition: transform 0.2s;
}

.footer-icons .icon:hover {
  transform: scale(1.2); /* little zoom effect */
}


  .footer {
    background: #111;
    color: #eee;
    padding: 2rem 1rem;
    margin-top: 3rem;
    position: relative;
  }

  .footer-container {
    max-width: 900px;
    margin: 0 auto;
    text-align: center;
  }

  .footer-top {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .footer-logo a {
    font-size: 1.5rem;
    font-weight: bold;
    color: #facc15;
    text-decoration: none;
  }

  .footer-nav {
    margin: 1rem 0;
  }

  .footer-nav a {
    margin: 0 0.75rem;
    color: #eee;
    text-decoration: none;
    transition: color 0.3s;
  }

  .footer-nav a:hover {
    color: #facc15;
  }

  .footer-copy {
    font-size: 0.9rem;
    color: #888;
  }

  .footer-social {
    position: absolute;
    right: 4rem;
    bottom: 2rem;
  }

  .footer-social a {
    margin-left: 1rem;
    font-size: 1.3rem;
    text-decoration: none;
    color: #eee;
    transition: color 0.3s;
  }

  .footer-social a:hover {
    color: #facc15;
  }
</style>


    <script type="module">
        const LECTO_API_KEY = "HQV0Q3X-HSZ4MA8-H78HQCX-QXWANF9";
        const LECTO_ENDPOINT = "https://api.lecto.ai/v1/translate/text";
        // Sample paragraphs for typing test
        const TYPING_PARAGRAPHS = [
            "The quick brown fox jumps over the lazy dog. This pangram contains every letter of the alphabet and is commonly used for typing practice. It helps improve speed and accuracy while ensuring all keys are tested.",
            "Technology has revolutionized the way we communicate and work. From instant messaging to video conferences, digital tools have made collaboration easier than ever before. Learning to type efficiently is essential in today's digital world.",
            "Practice makes perfect when it comes to typing skills. Regular exercise helps build muscle memory and increases speed over time. Focus on accuracy first, then gradually work on improving your words per minute.",
            "The art of writing has evolved significantly with the advent of computers. Touch typing allows writers to focus on their thoughts rather than hunting for keys. This skill becomes invaluable for students, professionals, and anyone who works with text.",
            "In the modern workplace, typing speed and accuracy can significantly impact productivity. Many jobs require extensive computer use, making touch typing an essential skill. The investment in learning proper technique pays dividends throughout one's career."
        ];
        async function translateViaLecto(textArr, to, from = "en") {
    if (to === "en") return [...textArr]; // No translation needed
    try {
        const resp = await fetch(LECTO_ENDPOINT, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
                "X-API-Key": LECTO_API_KEY,
            },
            body: JSON.stringify({ texts: textArr, to: [to], from }),
        });
        if (!resp.ok) throw new Error("API error " + resp.status);
        const data = await resp.json();
        return data.translations[0].translated || [...textArr];
    } catch (err) {
        console.error("Translation API failed:", err);
        return [...textArr];
    }
}


        // Application state
        let maxTime = 60;
        let timeLeft = maxTime;
        let timer = null;
        let charIndex = 0;
        let mistakes = 0;
        let isTyping = false;
        let finished = false;
        let currentText = "";
        let currentChars = [];

        // DOM elements
        const langSelect = document.getElementById('lang-select');
        const modeToggle = document.getElementById('modeToggle');
        const typingContainer = document.getElementById('typingContainer');
        const visualTimer = document.getElementById('visualTimer');
        const timeLeftSpan = document.getElementById('timeLeft');
        const startMsg = document.getElementById('startMsg');
        const endMsg = document.getElementById('endMsg');
        const typingText = document.getElementById('typingText');
        const mistakesSpan = document.getElementById('mistakes');
        const wpmSpan = document.getElementById('wpm');
        const cpmSpan = document.getElementById('cpm');
        const tryAgainBtn = document.getElementById('tryAgainBtn');
        const resetButton = document.getElementById('resetButton');
        const loader = document.getElementById('loader');

        // Utility functions
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function randomParagraph() {
            const randomIndex = Math.floor(Math.random() * TYPING_PARAGRAPHS.length);
            return TYPING_PARAGRAPHS[randomIndex];
        }

        function showLoader() {
            loader.style.display = 'flex';
            typingText.style.display = 'none';
        }

        function hideLoader() {
            loader.style.display = 'none';
            typingText.style.display = 'block';
        }

        function updateTimers() {
            const timeStr = formatTime(timeLeft);
            visualTimer.textContent = timeStr;
            timeLeftSpan.textContent = timeStr;
        }

        function updateStats() {
            const elapsed = (maxTime - timeLeft) / 60;
            const wpm = elapsed > 0 ? Math.round((charIndex - mistakes) / 5 / elapsed) : 0;
            const cpm = charIndex - mistakes;

            wpmSpan.textContent = Math.max(0, wpm);
            mistakesSpan.textContent = mistakes;
            cpmSpan.textContent = Math.max(0, cpm);
        }

        // Core typing test functions
       async function loadParagraph() {
    showLoader();

    setTimeout(async () => {
        currentText = randomParagraph();
        let displayText = currentText;

        // Translate only if language is not English
        const selectedLang = langSelect.value || "en";
        if (selectedLang !== "en") {
            const translated = await translateViaLecto([currentText], selectedLang, "en");
            displayText = translated[0] || currentText;
        }

        // Create spans for each character
        typingText.innerHTML = '';
        currentChars = [];

        for (let char of displayText) {
            const span = document.createElement('span');
            span.textContent = char;
            typingText.appendChild(span);
            currentChars.push(span);
        }

        if (currentChars.length > 0) currentChars[0].classList.add('active');

        hideLoader();
        resetStats();
    }, 500);
}


        function resetStats() {
            mistakesSpan.textContent = '0';
            wpmSpan.textContent = '0';
            cpmSpan.textContent = '0';
        }

        function startTest(inputChar) {
            if (isTyping || finished || loader.style.display === 'flex') return;
            
            isTyping = true;
            finished = false;
            startMsg.style.display = 'none';
            endMsg.style.display = 'none';
            
            handleInput(inputChar);
            startTimer();
        }

        function handleInput(inputChar) {
            if (finished || charIndex >= currentChars.length) return;
            
            const currentChar = currentChars[charIndex];
            const expectedChar = currentChar.textContent;
            
            // Remove active class from current character
            currentChar.classList.remove('active');
            
            // Check if input matches expected character
            if (inputChar === expectedChar) {
                currentChar.classList.add('correct');
            } else {
                currentChar.classList.add('incorrect');
                mistakes++;
            }
            
            charIndex++;
            
            // Set next character as active
            if (charIndex < currentChars.length) {
                currentChars[charIndex].classList.add('active');
            }
            
            updateStats();
            
            // Check if test is complete
            if (charIndex >= currentChars.length) {
                finishTest(true);
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            
            timer = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    updateTimers();
                    updateStats();
                } else {
                    finishTest(false);
                }
            }, 1000);
        }

       
import { saveScore, loadLeaderboard } from "/firebase/Firebaseconfig.js";  // import from your file

async function finishTest(completed) {
    clearInterval(timer);
    isTyping = false;
    finished = true;

    const finalWPM = parseInt(document.getElementById("wpm").textContent);

    if (finalWPM > 0) {
        const playerName = prompt("Typing finished! Enter your name:")?.trim();
        if (playerName) {
            await saveScore(playerName, finalWPM);  // now it works
            await loadLeaderboard();
        }
    }
}



        function resetGame() {
            clearInterval(timer);
            charIndex = 0;
            mistakes = 0;
            isTyping = false;
            finished = false;
            timeLeft = maxTime;
            
            updateTimers();
            loadParagraph();
            startMsg.style.display = 'block';
            endMsg.style.display = 'none';
        }

        // Event listeners
        document.addEventListener('keydown', async (e) => {
    if (['Shift','Control','Alt','Meta','CapsLock','Tab','Escape'].includes(e.key)) return;
    if (e.key === ' ' || e.key === 'Enter') e.preventDefault();

    if (e.key.length === 1 || e.key === ' ') {
        const inputChar = e.key === ' ' ? ' ' : e.key;

        if (!isTyping && !finished) {
            startTest(inputChar);
        } else if (isTyping && !finished) {
            await handleInput(inputChar); // <- async
        }
    }
});

        // Timer controls
        document.querySelectorAll('.controls button[data-time]').forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                document.querySelectorAll('.controls button[data-time]').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Add active class to clicked button
                button.classList.add('active');
                
                // Set new time
                const time = parseInt(button.getAttribute('data-time'));
                const unit = button.getAttribute('data-unit');
                
                maxTime = unit === 'minutes' ? time * 60 : time;
                resetGame();
            });
        });

        resetButton.addEventListener('click', resetGame);
        tryAgainBtn.addEventListener('click', resetGame);

        // Focus on typing container
        typingContainer.addEventListener('click', () => {
            typingContainer.focus();
        });

        // Theme toggle
        modeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light');
            const isLight = document.body.classList.contains('light');
            modeToggle.textContent = isLight ? 'â˜€ï¸' : 'ðŸŒ™';
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
        });

        // Load saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'light') {
            document.body.classList.add('light');
            modeToggle.textContent = 'â˜€ï¸';
        }

        // Language selector (placeholder functionality)
      langSelect.addEventListener('change', async () => {
    showLoader();
    resetStats();
    charIndex = 0;
    mistakes = 0;
    isTyping = false;
    finished = false;
    timeLeft = maxTime;
    updateTimers();
    
    await loadParagraph(); // waits for translation
});



        // Initialize the application
        function init() {
            updateTimers();
            loadParagraph();
            typingContainer.focus();
        }

        // Start the application
        init();
    </script>

    <script  type="module" src="firebase/Firebaseconfig.js"></script>
</body>
</html>